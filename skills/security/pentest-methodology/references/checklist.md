# Penetration Testing Checklist

> Source: pentest-checklist

## Phase 1: Scope Definition

### Define Objectives
- [ ] Clarify testing purpose (find vulnerabilities, compliance, customer assurance)
- [ ] Validate pentest necessity
- [ ] Align outcomes with objectives and define success criteria

**Key Questions:** Why are you doing this pentest? What outcomes do you expect? What will you do with findings?

### Test Types

| Type | Purpose | Scope |
|------|---------|-------|
| External Pentest | Assess external attack surface | Public-facing systems |
| Internal Pentest | Assess insider threat risk | Internal network |
| Web Application | Find application vulnerabilities | Specific applications |
| Social Engineering | Test human security | Employees, processes |
| Red Team | Full adversary simulation | Entire organization |

### Threat Enumeration
- [ ] Identify high-risk areas
- [ ] Assess data sensitivity
- [ ] Review legacy systems
- [ ] Map critical assets

### Define Scope
- [ ] List in-scope systems (IPs, domains, applications)
- [ ] Define out-of-scope items
- [ ] Set testing boundaries (allowed techniques)
- [ ] Document exclusions (third-party systems, production data)

### Budget Planning

| Factor | Consideration |
|--------|---------------|
| Asset Value | Higher value = higher investment |
| Complexity | More systems = more time |
| Depth Required | Thorough testing costs more |
| Reputation Value | Brand-name firms cost more |

## Phase 2: Environment Preparation

### Prepare Test Environment
- [ ] Production vs. staging decision
- [ ] Set testing limits (no DoS on production)
- [ ] Schedule testing window
- [ ] Create test accounts with appropriate access levels

### Run Preliminary Scans
- [ ] Execute vulnerability scanners
- [ ] Fix obvious vulnerabilities first
- [ ] Document existing issues and share with testers

```bash
nmap -sV --script vuln TARGET
nikto -h http://TARGET
```

### Administrative Preparation
- [ ] Verify compliance requirements (GDPR, PCI-DSS, HIPAA)
- [ ] Document data handling rules
- [ ] Confirm legal authorization (written permission)
- [ ] Check cloud provider policies (AWS, Azure, GCP)
- [ ] Submit authorization requests
- [ ] Stop deployments during testing (freeze developments)
- [ ] Document current system versions

## Phase 3: Expertise Selection

### Find Qualified Pentesters
- [ ] Seek recommendations from trusted sources
- [ ] Verify credentials (OSCP, GPEN, CEH, CREST)
- [ ] Check references
- [ ] Match expertise to scope (web, network, mobile)

### Testing Approach

| Type | Access Level | Simulates |
|------|-------------|-----------|
| Black Box | No information | External attacker |
| Gray Box | Partial access | Insider with limited access |
| White Box | Full access | Insider/detailed audit |

### Define Methodology
- [ ] Select testing standard (PTES, OWASP, NIST)
- [ ] Determine access level
- [ ] Agree on techniques (manual vs. automated)
- [ ] Set communication schedule

### Define Report Format
- [ ] Review sample reports
- [ ] Specify required sections
- [ ] Request machine-readable output (CSV, XML)
- [ ] Agree on risk ratings (CVSS, custom scale)

## Phase 4: Monitoring

### Security Monitoring
- [ ] Deploy IDS/IPS
- [ ] Enable comprehensive logging
- [ ] Configure SIEM
- [ ] Set up real-time alerting

**Key Logs to Monitor:** Authentication events, application errors, network connections, file access, system changes.

```bash
tail -f /var/log/auth.log
tail -f /var/log/apache2/access.log
tcpdump -i eth0 -w capture.pcap
```

### Operations Coordination
- [ ] Track error rate spikes
- [ ] Brief operations team (distinguish testing from attacks)
- [ ] Document baseline (normal vs. pentest activity)
- [ ] Review IDS/WAF alerts
- [ ] Check endpoint protection detections

## Phase 5: Remediation

### Backup & Recovery
- [ ] Verify backup integrity (test restoration)
- [ ] Document recovery procedures
- [ ] Separate backup access from testing

### Post-Test Actions
- [ ] Allocate team availability for post-pentest analysis
- [ ] Schedule fix implementation
- [ ] Plan verification testing
- [ ] Avoid patching during testing (except critical emergencies)
- [ ] Communicate any changes to pentesters

### Cleanup
- [ ] Remove test artifacts (backdoors, scripts, files)
- [ ] Delete test accounts
- [ ] Restore configurations
- [ ] Verify cleanup complete (audit all changes)

### Future Planning
- [ ] Determine frequency (annual, quarterly, after changes)
- [ ] Consider continuous testing (bug bounty, ongoing assessments)
- [ ] Budget for future tests

## Quick Reference

### Pre-Pentest
```
[ ] Scope defined and documented
[ ] Authorization obtained
[ ] Environment prepared
[ ] Hosting provider notified
[ ] Team briefed
[ ] Monitoring enabled
[ ] Backups verified
```

### Post-Pentest
```
[ ] Report received and reviewed
[ ] Findings prioritized
[ ] Remediation assigned
[ ] Fixes implemented
[ ] Verification testing scheduled
[ ] Environment cleaned up
[ ] Next test scheduled
```

## Troubleshooting

| Issue | Solution |
|-------|----------|
| Scope creep | Document and require change approval |
| Testing impacts production | Schedule off-hours, use staging |
| Findings disputed | Provide detailed evidence, retest |
| Remediation delayed | Prioritize by risk, set deadlines |
| Budget exceeded | Define clear scope, fixed-price contracts |
